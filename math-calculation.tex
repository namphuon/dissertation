\paragraph{Minimum Alignment Support Threshold. }
We now show how 
TIPP computes the probability that a fragment is
generated by a set of alignment subsets.
For a given HMMER model $H$ and fragment $x$, HMMER calculates a bit-score, defined as:
\begin{equation}
BS(H) = log_2 \frac{P(x|H)}{P(x|R)} \label{tipp:bitscore_equation}
\end{equation}
\noindent where $BS(H)$ is the bit-score for x on H, $P(x|H)$ 
is the probability of model H generating fragment $x$, and $P(x|R)$ is the probability of a random model R generating fragment $x$.
Thus models producing higher bit-scores are more likely to have generated the fragment. 


Assuming that a fragment $x$ is generated by 
exactly one  of the  HMMs $H_1$ to $H_n$ (each corresponding to a different alignment subset),
the probability that $H_i$ generated $x$ is:

\begin{equation}
P(H_i|x) = \frac{P(x|H_i)P(H_i)}{\sum_{j=1}^{n} P(x|H_j)P(H_j)}.\label{tipp:bitscore_equation_1}
\end{equation}

Assuming that uniform prior probability 
(i.e. $P(H_i)=P(H_j)$),
we can rewrite Equation~\ref{tipp:bitscore_equation_1} as:

\begin{equation}
P(H_i|x) = \frac{1}{\sum_{j=1}^{n} \frac{P(x|H_j)}{P(x|H_i)}}.\label{tipp:bitscore_equation_2}
\end{equation}

By Equation~\ref{tipp:bitscore_equation}, %$BS(H_j)-S(H_i)$ is:
 \begin{align}
{BS(H_j) - BS(H_i)}&= {\log_2 \frac{P(x|H_j)}{P(x|R)} - \log_2 \frac{P(x|H_i)}{P(x|R)}} \\=  \log_2\frac{P(x|H_j)}{P(x|H_i)}\label{tipp:bitscore_equation_4}
\end{align}

Substituting into Equation~\ref{tipp:bitscore_equation_2}, 
the result is the formula for computing the probability of $H_i$ using bit-scores:

\begin{equation}
P(H_i|x) = \frac{1}{\sum_{j=1}^{n} 2^{BS(H_j)-BS(H_i)}}
\end{equation}\label{tipp:bitscore_equation_5}
\noindent
Thus, 
assuming that the bit-scores are sorted such 
that $BS(A_i) \geq BS(A_{i+1})$ ($i=1,2,\ldots,n-1$), 
to reach a specified threshold $s_a$ we find the
smallest $m$ such that ${\sum_{k=1}^{m} P(H_k|x)} \geq s_a$.

